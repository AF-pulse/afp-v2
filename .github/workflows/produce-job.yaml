# produce-job.yaml
name: afp-produce-job
type: Microsoft.App/jobs
location: westeurope

properties:
  configuration:
    triggerType: Manual

  template:
    containers:
      - name: afp
        # Sätt en specifik tag (inte :latest). Workflowsen skriver ofta över detta med --image.
        image: afpacr.azurecr.io/afp-runner:gh-PLACEHOLDER
        env:
          - name: JOB_TYPE
            value: produce
          - name: READ_PREFIX
            value: "collector/"
          - name: BLOB_PREFIX
            value: "producer/"
          - name: BLOB_CONTAINER_SAS_URL
            # OBS: detta är NAMNET på hemligheten i ACA (gemener, inga underscore)
            secretRef: blob-container-sas-url

    resources:
      cpu: 0.5
      memory: "1Gi"
